<div id="title"></div>
<div id="price"></div>
<img id="product-img" />

<script>
async function fetchImage(title) {
    const res = await fetch(`/api/googleImage?q=${encodeURIComponent(title)}`);
    const data = await res.json();
    return data.image;
}

async function showDeal() {
    const response = await fetch("/deals/casque.json");
    const deal = await response.json();

    document.getElementById("title").innerText = deal.title;
    document.getElementById("price").innerText = deal.price;

    let imageUrl = deal.image;

    if (!imageUrl) {
        imageUrl = await fetchImage(deal.title);
    }

    const img = document.getElementById("product-img");

    if (imageUrl) {
        img.src = imageUrl;
    } else {
        img.src = "";
        img.alt = "Aucune image trouv√©e";
    }
}

showDeal();
</script>
