<script>
async function fetchGoogleImage(title) {
    try {
        const res = await fetch(`/api/google-image?q=${encodeURIComponent(title)}`);
        const data = await res.json();
        return data.image || null;
    } catch {
        return null;
    }
}

async function showDeal() {
    const res = await fetch("/deals/casque.json");
    const deal = await res.json();

    document.getElementById("title").innerText = deal.title;
    document.getElementById("price").innerText = deal.price;

    let imageUrl = deal.image;

    if (!imageUrl) {
        imageUrl = await fetchGoogleImage(deal.title);
    }

    const img = document.getElementById("product-img");

    if (imageUrl) {
        img.src = imageUrl;
    } else {
        img.innerText = "Aucune image trouv√©e";
    }
}

showDeal();
</script>
