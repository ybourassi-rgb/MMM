<script>
async function fetchGoogleImage(query) {
    try {
        const res = await fetch(`/api/google-image?q=${encodeURIComponent(query)}`);
        const data = await res.json();
        return data.image || null;
    } catch {
        return null;
    }
}

async function showDeal() {
    const response = await fetch("/deals/casque.json");
    const deal = await response.json();

    document.getElementById("title").innerText = deal.title;
    document.getElementById("price").innerText = deal.price;

    let imageUrl = deal.image;

    // si l'image du JSON ne marche pas → Google
    if (!imageUrl) {
        imageUrl = await fetchGoogleImage(deal.title);
    }

    const img = document.getElementById("product-img");

    if (imageUrl) {
        img.src = imageUrl;
    } else {
        img.src = "";
        img.alt = "Aucune image trouvée";
    }
}

showDeal();
</script>
